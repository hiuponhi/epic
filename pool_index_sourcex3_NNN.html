<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>–ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –ø—Ä–æ–ø–æ—Ä—Ü–∏–π</title>
<link rel="stylesheet" href="https://public.codepenassets.com/css/reset-2.0.min.css">
<style>
  :root {
    --card-height: 100vh;
    --proportion: 1.5;
    --card-width: calc(var(--card-height) / var(--proportion));
  }

  body {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
  }

  .card{
    flex: 0 1 var(--card-width);
    height: var(--card-height);
    box-sizing: border-box;
    border: 5px solid orange;
    position: relative;
    cursor: pointer;
    transition: transform 0.3s ease;
    overflow: hidden;
  }

  .card:hover {
    transform: scale(1.02);
  }

  @media (max-aspect-ratio: 2/3){
    .card {
      height: 150vw;
    }
  }

  .red { background-color: #f44336; }
  .orange { background-color: #ff9800; }
  .yellow { background-color: #ffeb3b; }
  .green { background-color: #4caf50; }
  .blue { background-color: #2196f3; }
  .indigo { background-color: #3f51b5; color: #fff; }
  .violet { background-color: #9c27b0; }

  .download-panel {
    position: absolute;
    bottom: 0px; left: 0px; right: 0px;
    display: flex;
    flex-direction: column;
    gap: 6px;
    background: white;
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
    z-index: 10;
    pointer-events: none;
    font-family: Arial, sans-serif;
    padding: 8px;
  }

  .card:hover .download-panel {
    opacity: 1;
    visibility: visible;
    pointer-events: auto;
  }

  .download-buttons {
    display: flex;
    flex-wrap: wrap;
    gap: 4px;
    justify-content: flex-start;
  }

</style>

<script id="smart-download-manager">
  document.addEventListener('DOMContentLoaded', () => {
    // 1. –î–ê–Å–ú ID –ö–ê–†–¢–û–ß–ö–ê–ú + —Å–æ–∑–¥–∞—ë–º –ø–∞–Ω–µ–ª—å
    document.querySelectorAll('.card').forEach((card, index) => {
      card.id = `card-${index + 1}`;
      const panel = document.createElement('div');
      panel.className = 'download-panel';
      panel.innerHTML = `
        <div class="download-buttons">
          <button class="download-btn download-single" data-card="${card.id}">üì∏ ${card.id} (8K)</button>
          <button class="download-btn download-all">üì¶ –í—Å–µ –∫–∞—Ä—Ç–æ—á–∫–∏ (4K)</button>
        </div>
      `;
      card.appendChild(panel);
    });

    // 2. –ó–ê–ì–†–£–ó–ö–ê html2canvas
    const script = document.createElement('script');
    script.src = 'https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js';
    document.head.appendChild(script);

    // 3. –ö–ù–û–ü–ö–ò (–ø–æ—Å–ª–µ html2canvas)
    script.onload = () => {
      // –ö–Ω–æ–ø–∫–∏ "—ç—Ç—É –∫–∞—Ä—Ç–æ—á–∫—É"
      document.querySelectorAll('.download-single').forEach(btn => {
        btn.onclick = async () => {
          const cardId = btn.dataset.card;
          const card = document.getElementById(cardId);
          await saveCard(card, 8640, `${cardId}-8k.png`);
        };
      });

      // –ö–Ω–æ–ø–∫–∏ "–≤—Å–µ –∫–∞—Ä—Ç–æ—á–∫–∏"
      document.querySelectorAll('.download-all').forEach(btn => {
        btn.onclick = async () => {
          const cards = document.querySelectorAll('.card');
          for (let i = 0; i < cards.length; i++) {
            await saveCard(cards[i], 4320, `card-${i + 1}-4k.png`);
          }
        };
      });

      console.log('‚úÖ –ü—Ä–æ—Å—Ç–∞—è hover-–ª–æ–≥–∏–∫–∞ –≥–æ—Ç–æ–≤–∞!');
    };
  });

  async function saveCard(card, desiredWidth, filename) {
    const scale = desiredWidth / card.offsetWidth;
    try {
      const canvas = await html2canvas(card, { 
        scale, 
        useCORS: true, 
        allowTaint: true,
        backgroundColor: null
      });
      
      const link = document.createElement('a');
      link.href = canvas.toDataURL('image/png');
      link.download = filename;
      link.click();
    } catch (e) {
      console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:', e);
    }
  }
</script>

</head>

<body>
<div class="card">
  <header>–ó–∞–≥–æ–ª–æ–≤–æ–∫</header>
  <main>
    <div class="line red">–°—Ç—Ä–æ–∫–∞ 1</div>
    <div class="line orange">–°—Ç—Ä–æ–∫–∞ 2</div>
    <div class="line yellow">–°—Ç—Ä–æ–∫–∞ 3</div>
    <div class="line green">–°—Ç—Ä–æ–∫–∞ 4</div>
    <div class="line blue">–°—Ç—Ä–æ–∫–∞ 5</div>
    <div class="line indigo">–°—Ç—Ä–æ–∫–∞ 6</div>
    <div class="line violet">–°—Ç—Ä–æ–∫–∞ 7</div>
  </main>
  <footer>–§—É—Ç–µ—Ä</footer>
</div>
<div class="card">
  <header>–ó–∞–≥–æ–ª–æ–≤–æ–∫</header>
  <main>
    <div class="line red">–°—Ç—Ä–æ–∫–∞ 1</div>
    <div class="line orange">–°—Ç—Ä–æ–∫–∞ 2</div>
    <div class="line yellow">–°—Ç—Ä–æ–∫–∞ 3</div>
    <div class="line green">–°—Ç—Ä–æ–∫–∞ 4</div>
    <div class="line blue">–°—Ç—Ä–æ–∫–∞ 5</div>
    <div class="line indigo">–°—Ç—Ä–æ–∫–∞ 6</div>
    <div class="line violet">–°—Ç—Ä–æ–∫–∞ 7</div>
  </main>
  <footer>–§—É—Ç–µ—Ä</footer>
</div>
<div class="card">
  <header>–ó–∞–≥–æ–ª–æ–≤–æ–∫</header>
  <main>
    <div class="line red">–°—Ç—Ä–æ–∫–∞ 1</div>
    <div class="line orange">–°—Ç—Ä–æ–∫–∞ 2</div>
    <div class="line yellow">–°—Ç—Ä–æ–∫–∞ 3</div>
    <div class="line green">–°—Ç—Ä–æ–∫–∞ 4</div>
    <div class="line blue">–°—Ç—Ä–æ–∫–∞ 5</div>
    <div class="line indigo">–°—Ç—Ä–æ–∫–∞ 6</div>
    <div class="line violet">–°—Ç—Ä–æ–∫–∞ 7</div>
  </main>
  <footer>–§—É—Ç–µ—Ä</footer>
</div>
<div class="card">
  <header>–ó–∞–≥–æ–ª–æ–≤–æ–∫</header>
  <main>
    <div class="line red">–°—Ç—Ä–æ–∫–∞ 1</div>
    <div class="line orange">–°—Ç—Ä–æ–∫–∞ 2</div>
    <div class="line yellow">–°—Ç—Ä–æ–∫–∞ 3</div>
    <div class="line green">–°—Ç—Ä–æ–∫–∞ 4</div>
    <div class="line blue">–°—Ç—Ä–æ–∫–∞ 5</div>
    <div class="line indigo">–°—Ç—Ä–æ–∫–∞ 6</div>
    <div class="line violet">–°—Ç—Ä–æ–∫–∞ 7</div>
  </main>
  <footer>–§—É—Ç–µ—Ä</footer>
</div>
</body>
</html>
